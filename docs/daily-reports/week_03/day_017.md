**Day 17 – Learning Report**

---

### Goals for Today

* Understand application lifecycle in FastAPI (startup / shutdown).
* Learn how `lifespan` works and why it is part of app creation.
* Build a correct mental model for `yield` in lifecycle and dependencies.
* Clearly distinguish `async`, `await`, generators, and coroutines.
* Understand Dependency Injection conceptually, not just syntactically.
* Learn how FastAPI manages dependency lifecycle using `yield`.

---

### What I Learned

* **Application Lifecycle**

  * FastAPI applications have a defined lifecycle: startup → serving → shutdown.
  * `lifespan` is the correct place for system-level initialization and cleanup.
  * Lifecycle logic must not run at import-time.

* **`yield` vs `return`**

  * `return` ends a function permanently.
  * `yield` pauses execution and allows it to resume later.
  * FastAPI relies on pause/resume to manage resource lifetime correctly.

* **Generators and Pause/Resume**

  * Functions with `yield` become generators.
  * Generators are not re-called; they are resumed from the last suspension point.
  * Cleanup logic after `yield` executes only when the consumer signals completion.

* **Dependency Injection (DI)**

  * DI means declaring what a function needs, not how to build it.
  * Dependencies should be injected, not created inside endpoints.
  * Using `yield` in dependencies enables proper resource cleanup.

* **Why `return` Breaks DI Cleanup**

  * With `return`, FastAPI has no hook to run teardown logic.
  * `yield` keeps the dependency alive until the request is fully processed.

* **`async`, `await`, and Event Loop**

  * `async` functions produce coroutines controlled by the event loop.
  * `await` suspends execution until an async operation completes.
  * Async provides concurrency, not parallelism.

* **`@asynccontextmanager`**

  * Converts an async function with `yield` into a real async context manager.
  * Maps code before `yield` to setup, and after `yield` to teardown.
  * Used internally by FastAPI for both lifespan and dependency management.

---

### Project Structure (Current)

* `app/`

  * `main.py` – application factory, logging setup, lifespan definition
  * `settings.py` – configuration via environment variables
  * `logging.py` – centralized logging configuration

---

This day solidified the mental model behind lifecycle management, generators, and dependency injection, forming a critical foundation for upcoming work with databases and async resources.
