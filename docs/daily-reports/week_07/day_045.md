## Day 45 — Daily Report

### Goals

* Move the **Create User** business logic out of the HTTP route and into the **application layer service**.
* Keep routes “thin”: handle only HTTP I/O (validation, status codes, response model), then delegate to service.
* Establish a consistent dependency-injection pattern for services (via `Depends(...)`).

### What I Learned

* **Route vs Service responsibilities**

  * Routes are HTTP adapters (request/response orchestration).
  * Services implement **use-cases** (business flow) and should not depend on FastAPI.
* **Where pagination belongs (principle)**

  * Route: parse/validate `page/size`.
  * Service (or later repository/query layer): compute `offset/limit`, return `(items, total)` in a stable contract.
* **DTO boundaries**

  * Passing API schemas (e.g., `UserCreate`) into the service works but increases coupling.
  * Prefer passing **primitives** (e.g., `email`, `name`) or later an **application-level command** (not today).
* **Keyword-only arguments (`*`)**

  * Using `def create_user(self, *, email: str, name: str)` forces explicit calls like `create_user(email=..., name=...)`, reducing parameter-order bugs and making service contracts clearer.
* **State and lifetime**

  * With in-memory storage, you must be deliberate about where state lives (shared storage vs singleton-like behavior). This becomes simpler once persistence moves to DB/repository.

### Project Structure (Current)

* `app/main.py` — FastAPI app setup
* `app/api/router.py` — API router aggregation
* `app/api/v1/users.py` — Users HTTP routes (Create now delegates to service; Update/Delete still being migrated)
* `app/schemas/`

  * `user.py` — `UserCreate`, `UserResponse`, etc.
  * `common.py` — `Page`, shared response helpers
* `app/application/users/service.py` — User use-case logic (Create moved here; list/pagination logic here for now)
* `app/deps.py` — dependency injection utilities (project-level DI home)
* `app/domain/` — domain placeholders for later (entities/rules/errors)
* `app/infrastructure/` — placeholders for later (DB/redis/etc.)
