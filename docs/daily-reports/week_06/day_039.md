## Day 39 Report

### ðŸŽ¯ Goals

* Implement `POST /v1/users` to create a new user.
* Enforce correct HTTP semantics (`201 Created`).
* Apply `response_model` properly as an API contract.
* Implement `GET /v1/users/{id}` with proper `404` handling.
* Start implementing `GET /v1/users` with basic pagination.
* Understand the difference between manual `JSONResponse` and `HTTPException`.
* Make storage and response representation consistent.

---

## ðŸ“˜ What I Learned

### API & HTTP

* In REST, the URL represents the **resource**, and the HTTP method represents the **action**.
* `POST /users` is correct for creation; no need for `/users/create`.
* `201` must be used for successful creation.
* `404` should be raised via `HTTPException`, not manually returned.

### response_model & Validation

* `response_model` enforces output structure but does not replace input validation.
* If I want fail-fast behavior on return values, I should explicitly construct `UserResponse`.
* Returning a Pydantic model is cleaner than returning `model_dump()` when `response_model` is defined.
* FastAPI default error response uses `"detail"` field.
* `responses={...}` only affects documentation, not actual runtime behavior.

### State & Consistency

* Difference between mutation and rebinding (`global` needed only for rebinding).
* Storage must have a single source of truth (avoid mixing dict and model representations).
* Decided to store `UserResponse` models directly in memory for consistency.

### Error Handling Architecture

* Routes should raise exceptions, not format error responses.
* Formatting errors should be handled in a centralized exception handler.
* This follows Separation of Concerns and improves maintainability.

### Pagination Basics

* Implemented query parameters with validation (`ge`, `le`).
* Understood that `max_length` is for strings, not integers.
* Introduced `Page[UserResponse]` as a generic response wrapper.

---

## ðŸ—‚ Project Structure So Far

```
app/
  main.py
  settings.py
  logging.py
  deps.py

  api/
    health.py
    router.py
    v1/
      router.py
      users.py

  schemas/
    user.py
    common.py
```

### Current Capabilities

* Versioned API (`/v1`)
* Health endpoint
* Create user (POST)
* Get single user (GET by id)
* Basic paginated list endpoint
* Structured schemas
* In-memory storage
* HTTP exception handling

---

At this point:

* CRUD foundation is partially complete (Create + Read).
* API contract discipline is established.
* Error handling flow is conceptually understood.
* Project structure remains modular and clean.
